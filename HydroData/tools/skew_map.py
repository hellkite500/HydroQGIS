#!/usr/bin/env python

"""
Generalized Skew map for Western United States

This is a two dimensional dictionary.  The first key is the latitude grid, the second key is the longitude grid,
the resulting value is the generalized skew for that grid from the skew_coefficients_large.pdf map

So for example, any latitude between 31 and 32 degrees, with a corresponding longitutde between 100 and 101 degrees,
would have a generalized skew of -0.76

Missing values are given by the empty string "", and can be filled in based on the iso lines (Bulliten 17B)

Since this is a Python file, indentation is important, and must be consistent.  The indentation in this file curretnly uses
SPACES (four spaces per level)  If you use a TABS mixed with spaces, the interperter will throw an error!!!

FIXME I realized that the longitude in this mapping isn't quite right...they should technically be negatives!!!
Temporary fix is to use abs() before creating the key to index the map...should probably fix this...
"""

_skewMap = {
    #Lattitude
    '31_32' : {
            #Longitude
            '100_101' : -0.76,#Skew Value
            '101_102' : "",
            '102_103' : -0.10,
            '103_104' : 0.0,
            '104_105' : 0.0,
            '105_106' : -0.10,
            '106_107' : -0.15,
            '107_108' : "",
            '108_109' : "",
            '109_110' : "",
            '110_111' : -0.01,
            '111_112' : -0.15,
            '112_113' : 0.0,
            '113_114' : "",
            '114_115' : "",
            '115_116' : "",
            '116_117' : "",
            '117_118' : "",
            '118_119' : "",
            '119_120' : "",
            '120_121' : "",
            '121_122' : "",
            '122_123' : "",
            '123_124' : "",
            '124_125' : "",
            },

    '32_33' : {
            '100_101' : "",
            '101_102' : "",
            '102_103' : -0.10,
            '103_104' : -0.05,
            '104_105' : 0.1,
            '105_106' : -0.05,
            '106_107' : -0.10,
            '107_108' : -0.86,
            '108_109' : -0.65,
            '109_110' : -0.40,
            '110_111' : -0.01,
            '111_112' : -0.33,
            '112_113' : -0.20,
            '113_114' : -0.05,
            '114_115' : 0,
            '115_116' : 0.1,
            '116_117' : -0.16,
            '117_118' : -0.30,
            '118_119' : "",
            '119_120' : "",
            '120_121' : "",
            '121_122' : "",
            '122_123' : "",
            '123_124' : "",
            '124_125' : "",
            },

    '33_34' : {
            '100_101' : -0.45,
            '101_102' : -0.10,
            '102_103' : -0.10,
            '103_104' : -0.05,
            '104_105' : -0.41,
            '105_106' : -0.04,
            '106_107' : -0.05,
            '107_108' : 0.21,
            '108_109' : -0.04,
            '109_110' : -0.12,
            '110_111' : -0.02,
            '111_112' : -0.18,
            '112_113' : -0.10,
            '113_114' : -0.05,
            '114_115' : 0,
            '115_116' : 0.2,
            '116_117' : 0.10,
            '117_118' : -0.29,
            '118_119' : -0.41,
            '119_120' : "",
            '120_121' : "",
            '121_122' : "",
            '122_123' : "",
            '123_124' : "",
            '124_125' : "",
            },

    '34_35' : {
            '100_101' : "",
            '101_102' : -0.64,
            '102_103' : -0.10,
            '103_104' : -0.05,
            '104_105' : -0.26,
            '105_106' : -0.05,
            '106_107' : -0.90,
            '107_108' : 0.0,
            '108_109' : -0.10,
            '109_110' : -0.11,
            '110_111' : 0.13,
            '111_112' : -0.33,
            '112_113' : 0.32,
            '113_114' : -0.46,
            '114_115' : 0,
            '115_116' : 0.1,
            '116_117' : 0.20,
            '117_118' : 0.12,
            '118_119' : -0.45,
            '119_120' : -0.37,
            '120_121' : 0.48,
            '121_122' : "",
            '122_123' : "",
            '123_124' : "",
            '124_125' : "",
            },

    '35_36' : {
            '100_101' : -0.15,
            '101_102' : -0.10,
            '102_103' : -0.05,
            '103_104' : -0.53,
            '104_105' : 0.26,
            '105_106' : 0.2,
            '106_107' : -0.15,
            '107_108' : 0.36,
            '108_109' : 0,
            '109_110' : -0.05,
            '110_111' : -0.05,
            '111_112' : -0.05,
            '112_113' : -0.05,
            '113_114' : -0.05,
            '114_115' : 0,
            '115_116' : 0,
            '116_117' : 0.10,
            '117_118' : 0.20,
            '118_119' : 0.66,
            '119_120' : -1.50,
            '120_121' : -0.38,
            '121_122' : "",
            '122_123' : "",
            '123_124' : "",
            '124_125' : "",
            },

    '36_37' : {
            '100_101' : -0.10,
            '101_102' : -0.38,
            '102_103' : -0.05,
            '103_104' : 0.66,
            '104_105' : 0.66,
            '105_106' : -0.36,
            '106_107' : -0.18,
            '107_108' : -0.05,
            '108_109' : 0.03,
            '109_110' : -0.05,
            '110_111' : 0,
            '111_112' : -0.59,
            '112_113' : 0.23,
            '113_114' : 0,
            '114_115' : 0,
            '115_116' : 0,
            '116_117' : 0,
            '117_118' : 0.10,
            '118_119' : -0.14,
            '119_120' : 0.87,
            '120_121' : -0.09,
            '121_122' : -0.56,
            '122_123' : "",
            '123_124' : "",
            '124_125' : "",
            },

    '37_38' : {
            '100_101' : -0.59,
            '101_102' : -0.05,
            '102_103' : -0.05,
            '103_104' : -0.60,
            '104_105' : -0.48,
            '105_106' : -0.18,
            '106_107' : 0.02,
            '107_108' : 0.58,
            '108_109' : -0.19,
            '109_110' : -0.05,
            '110_111' : -0.05,
            '111_112' : -0.05,
            '112_113' : -0.15,
            '113_114' : 0.06,
            '114_115' : 0,
            '115_116' : 0,
            '116_117' : 0,
            '117_118' : 0,
            '118_119' : -0.24,
            '119_120' : 0.44,
            '120_121' : 0.10,
            '121_122' : -0.70,
            '122_123' : -0.49,
            '123_124' : "",
            '124_125' : "",
            },

    '38_39' : {
            '100_101' : -0.05,
            '101_102' : -0.05,
            '102_103' : -0.05,
            '103_104' : -0.34,
            '104_105' : 0.11,
            '105_106' : 0.36,
            '106_107' : -0.06,
            '107_108' : -0.27,
            '108_109' : -0.09,
            '109_110' : 0.23,
            '110_111' : -0.15,
            '111_112' : -0.47,
            '112_113' : 0.41,
            '113_114' : 0,
            '114_115' : 0,
            '115_116' : 0,
            '116_117' : 0,
            '117_118' : 0,
            '118_119' : 0,
            '119_120' : 0.65,
            '120_121' : 0.21,
            '121_122' : -0.36,
            '122_123' : -0.88,
            '123_124' : 0.58,
            '124_125' : "",
            },

    '39_40' : {
            '100_101' : 0.29,
            '101_102' : -0.05,
            '102_103' : -0.05,
            '103_104' : -0.05,
            '104_105' : -0.14,
            '105_106' : 0.05,
            '106_107' : -0.55,
            '107_108' : -0.10,
            '108_109' : -0.30,
            '109_110' : -0.30,
            '110_111' : 0.18,
            '111_112' : -0.27,
            '112_113' : -0.20,
            '113_114' : -0.10,
            '114_115' : 0,
            '115_116' : 0,
            '116_117' : 0,
            '117_118' : 0,
            '118_119' : 0,
            '119_120' : 0.04,
            '120_121' : 0.35,
            '121_122' : -0.47,
            '122_123' : -0.53,
            '123_124' : 0.22,
            '124_125' : "",
            },

    '40_41' : {
            '100_101' : 0.01,
            '101_102' : 0.17,
            '102_103' : 0.48,
            '103_104' : -0.05,
            '104_105' : -0.08,
            '105_106' : -0.18,
            '106_107' : -0.28,
            '107_108' : -0.31,
            '108_109' : -0.30,
            '109_110' : -0.37,
            '110_111' : -0.22,
            '111_112' : -0.46,
            '112_113' : -0.93,
            '113_114' : -0.20,
            '114_115' : -0.1,
            '115_116' : -0.24,
            '116_117' : 0.03,
            '117_118' : 0,
            '118_119' : 0,
            '119_120' : 0,
            '120_121' : -0.16,
            '121_122' : 0.55,
            '122_123' : -0.39,
            '123_124' : -0.06,
            '124_125' : "",
            },

    '41_42' : {
            '100_101' : 0.99,
            '101_102' : 1.13,
            '102_103' : 0.88,
            '103_104' : 0.28,
            '104_105' : 0,
            '105_106' : 0.35,
            '106_107' : -0.40,
            '107_108' : -0.51,
            '108_109' : -0.30,
            '109_110' : -0.30,
            '110_111' : -0.62,
            '111_112' : -0.64,
            '112_113' : -0.30,
            '113_114' : 0.16,
            '114_115' : -0.66,
            '115_116' : 0.45,
            '116_117' : 0,
            '117_118' : 0.3,
            '118_119' : 0,
            '119_120' : 0,
            '120_121' : 0,
            '121_122' : 0.2,
            '122_123' : 0.43,
            '123_124' : 0,
            '124_125' : 0.23,
            },

    '42_43' : {
            '100_101' : 0.6,
            '101_102' : 0.6,
            '102_103' : 0.6,
            '103_104' : 0.71,
            '104_105' : 0.3,
            '105_106' : 1.39,
            '106_107' : -0.10,
            '107_108' : 1.07,
            '108_109' : -0.46,
            '109_110' : -0.42,
            '110_111' : -0.57,
            '111_112' : -0.73,
            '112_113' : 1.22,
            '113_114' : 0.66,
            '114_115' : -0.81,
            '115_116' : -0.21,
            '116_117' : -0.1,
            '117_118' : 0,
            '118_119' : -0.32,
            '119_120' : -0.32,
            '120_121' : 0.05,
            '121_122' : 0.33,
            '122_123' : 0.32,
            '123_124' : -0.56,
            '124_125' : 0.04,
            },

    '43_44' : {
            '100_101' : 0.67,
            '101_102' : 0.6,
            '102_103' : 0.16,
            '103_104' : 0.42,
            '104_105' : 0.3,
            '105_106' : 0,
            '106_107' : 0,
            '107_108' : 0,
            '108_109' : -0.20,
            '109_110' : 0.07,
            '110_111' : -0.53,
            '111_112' : -0.33,
            '112_113' : -0.30,
            '113_114' : -0.97,
            '114_115' : -0.26,
            '115_116' : -0.27,
            '116_117' : -0.15,
            '117_118' : -0.10,
            '118_119' : 0.06,
            '119_120' : -0.23,
            '120_121' : 0,
            '121_122' : -0.28,
            '122_123' : 0.12,
            '123_124' : -0.29,
            '124_125' : "",
            },

    '44_45' : {
            '100_101' : 0,
            '101_102' : 0.96,
            '102_103' : -0.06,
            '103_104' : 0.93,
            '104_105' : 0,
            '105_106' : 0,
            '106_107' : 0.45,
            '107_108' : 0.26,
            '108_109' : -0.29,
            '109_110' : 0.51,
            '110_111' : -0.33,
            '111_112' : -0.49,
            '112_113' : 0.16,
            '113_114' : -0.3,
            '114_115' : -0.23,
            '115_116' : 0.18,
            '116_117' : -0.8,
            '117_118' : -0.60,
            '118_119' : -0.09,
            '119_120' : 0.20,
            '120_121' : -0.48,
            '121_122' : 0.58,
            '122_123' : 0.02,
            '123_124' : -0.17,
            '124_125' : "",
            },

    '45_46' : {
            '100_101' : -0.25,
            '101_102' : -0.20,
            '102_103' : -0.06,
            '103_104' : 0.23,
            '104_105' : -0.71,
            '105_106' : -0.82,
            '106_107' : 0,
            '107_108' : 0.11,
            '108_109' : -0.34,
            '109_110' : 0.03,
            '110_111' : 0.09,
            '111_112' : 0.13,
            '112_113' : -0.29,
            '113_114' : -0.3,
            '114_115' : -0.75,
            '115_116' : -0.12,
            '116_117' : 0.40,
            '117_118' : -0.07,
            '118_119' : 0.43,
            '119_120' : 0.90,
            '120_121' : 0,
            '121_122' : -0.19,
            '122_123' : 0.08,
            '123_124' : 0.44,
            '124_125' : "",
            },

    '46_47' : {
            '100_101' : -0.79,
            '101_102' : 0.12,
            '102_103' : -0.59,
            '103_104' : -0.32,
            '104_105' : -1.03,
            '105_106' : -0.20,
            '106_107' : -0.10,
            '107_108' : 0,
            '108_109' : -0.58,
            '109_110' : -0.21,
            '110_111' : -0.31,
            '111_112' : 0.12,
            '112_113' : -0.19,
            '113_114' : -0.23,
            '114_115' : -0.30,
            '115_116' : 0,
            '116_117' : 0,
            '117_118' : 0.27,
            '118_119' : -0.51,
            '119_120' : -0.05,
            '120_121' : -0.02,
            '121_122' : 0.02,
            '122_123' : 0.34,
            '123_124' : 0.14,
            '124_125' : "",
            },

    '47_48' : {
            '100_101' : -0.40,
            '101_102' : -0.51,
            '102_103' : -0.26,
            '103_104' : -0.40,
            '104_105' : -0.40,
            '105_106' : -1.44,
            '106_107' : -0.61,
            '107_108' : -0.30,
            '108_109' : -0.10,
            '109_110' : -0.05,
            '110_111' : 0.20,
            '111_112' : 1.84,
            '112_113' : 1.12,
            '113_114' : 0.20,
            '114_115' : -0.40,
            '115_116' : -0.30,
            '116_117' : 0.08,
            '117_118' : -0.57,
            '118_119' : -0.35,
            '119_120' : 0.31,
            '120_121' : -0.35,
            '121_122' : 0.12,
            '122_123' : 0.02,
            '123_124' : -.06,
            '124_125' : 0.26,
            },

    '48_49' : {
            '100_101' : 0.20,
            '101_102' : -0.52,
            '102_103' : -0.40,
            '103_104' : -0.40,
            '104_105' : -0.40,
            '105_106' : -0.18,
            '106_107' : -0.96,
            '107_108' : -0.55,
            '108_109' : -0.30,
            '109_110' : -0.63,
            '110_111' : 0,
            '111_112' : 0.15,
            '112_113' : 1.78,
            '113_114' : 0.68,
            '114_115' : 0.56,
            '115_116' : -0.05,
            '116_117' : -0.51,
            '117_118' : -0.23,
            '118_119' : -0.46,
            '119_120' : -0.20,
            '120_121' : -0.08,
            '121_122' : 0.26,
            '122_123' : -0.33,
            '123_124' : -0.09,
            '124_125' : 0.20,
            },
    #hack to accomadate ONE station in the mid_west_range in Canada!
    '49_50' : {
			
            '114_115' : 0.60
            }
} #End skew dict

def getSkew(data):
    #make sure lat/long are converted to ints.  This drops the decimals
    #so that the key's can be constructed correctly.
    lat = abs(int(float(data['dec_lat_va'])))
    lon = abs(int(float(data['dec_long_va'])))
    latKey = str(lat)+'_'+str(lat+1)
    lonKey = str(lon)+'_'+str(lon+1)
    return _skewMap[latKey][lonKey]
    
def _getSkew(lat, lon):
    lat = abs(lat)
    lon = abs(lon)
    latKey = str(lat)+'_'+str(lat+1)
    lonKey = str(lon)+'_'+str(lon+1)
    return _skewMap[latKey][lonKey]
        
if __name__=='__main__':
    import sys
    if len(sys.argv) != 3:
        print "Invalid arguements, must provide latitutde and longitude"
    else:
        lat = float(sys.argv[1])
        lon = float(sys.argv[2])
        print _getSkew(int(lat), int(lon))
